<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<script>
//    // 定义一个数据模型book
//    var book = {
//        name:'java',
//        price:30,
//        rel:{
//            bk:'sql'
//        }
//    };
//    //定义监听方法
//    function listen(changes){
//        changes.forEach(function(change, i){
//            console.log('what property changed? ' + change.name);
//            console.log('how did it change? ' + change.type);
//            console.log('whats the current value? ' + change.object[change.name]);
//            console.log(change); // 所有变化
//        });
//    };
//    //绑定
//    Object.observe(book, listen);
//    //Object.observe(book, listen, ['delete']);
//    //解除监听
//    //Object.unobserve(book, listen);





//    // 定义一个简单模型
//    var book = {
//        author: {}
//    };
//
//    // 一个独立变量，一会儿用于模型的getter方法
//    var _name = 'lee';
//
//    // 给「author」定义一个新属性「name」，并为「name」指定自定义的getter和setter
//    Object.defineProperty(book.author, 'name', {
//        get: function () {
//            return _name;
//        },
//        set: function (name) {
//            // 一旦对「name」进行赋值，就会发出一个指定变化类型的通知。
//            // 这给了你很大的空间控制通知。
//            Object.getNotifier(this).notify({
//                type: 'update',
//                name: 'name',
//                current:name,
//                oldValue: _name
//            });
//
//            // 将新的值在控制台中输出
//            console.log('set', name);
//
//            _name = name;
//        }
//    });
//
//    // 设置我们的监听器
//    function observer(changes) {
//        changes.forEach(function (change, i) {
//            console.log(change);
//        })
//    }
//    // 开始监听book.author
//    Object.observe(book.author, observer);


//
//function Circle(r) {
//    var radius = r;
//
//    var notifier = Object.getNotifier(this);
//    function notifyAreaAndRadius(radius) {
//        notifier.notify({
//            type: 'update',
//            name: 'radius',
//            oldValue: radius
//        })
//        notifier.notify({
//            type: 'update',
//            name: 'area',
//            oldValue: Math.pow(radius * Math.PI, 2)
//        });
//    }
//
//    Object.defineProperty(this, 'radius', {
//        get: function() {
//            return radius;
//        },
//        set: function(r) {
//            if (radius === r)
//                return;
//            notifyAreaAndRadius(radius);
//            radius = r;
//        }
//    });
//
//    Object.defineProperty(this, 'area', {
//        get: function() {
//            return Math.pow(radius, 2) * Math.PI;
//        },
//        set: function(a) {
//            r = Math.sqrt(a/Math.PI);
//            notifyAreaAndRadius(radius);
//            radius = r;
//        }
//    });
//}
//
//function observer(changes){
//    changes.forEach(function(change, i){
//        console.log(change);
//    })
//}
//
//var cc = new Circle(10);
//Object.observe(cc,observer);



//function Thingy(a, b,c) {
//    this.a = a;
//    this.b = b;
//}
//
//Thingy.MULTIPLY = 'multiply';
//Thingy.INCREMENT = 'increment';
//Thingy.INCREMENT_AND_MULTIPLY = 'incrementAndMultiply';
//
//
//Thingy.prototype = {
//    increment: function(amount) {
//        var notifier = Object.getNotifier(this);
//
//        // 告知系统一组结果组合成了一个特殊类型的变化
//        // notifier.performChange('foo', performFooChangeFn);
//        // notifier.notify('foo', 'fooChangeRecord');
//        notifier.performChange(Thingy.INCREMENT, function() {
//            this.a += amount;
//            this.b += amount;
//        }, this);
//
//        notifier.notify({
//            object: this,
//            type: Thingy.INCREMENT,
//            incremented: amount
//        });
//    },
//
//    multiply: function(amount) {
//        var notifier = Object.getNotifier(this);
//
//        notifier.performChange(Thingy.MULTIPLY, function() {
//            this.a *= amount;
//            this.b *= amount;
//        }, this);
//
//        notifier.notify({
//            object: this,
//            type: Thingy.MULTIPLY,
//            multiplied: amount
//        });
//    },
//
//    incrementAndMultiply: function(incAmount, multAmount) {
//        var notifier = Object.getNotifier(this);
//
//        notifier.performChange(Thingy.INCREMENT_AND_MULTIPLY, function() {
//            this.increment(incAmount);
//            this.multiply(multAmount);
//        }, this);
//
//        notifier.notify({
//            object: this,
//            type: Thingy.INCREMENT_AND_MULTIPLY,
//            incremented: incAmount,
//            multiplied: multAmount
//        });
//    }
//}
//var observer = {
//    records: undefined,
//    callbackCount: 0,
//    reset: function() {
//        this.records = undefined;
//        this.callbackCount = 0;
//    }
//};
//var observer2 = {
//    records: undefined,
//    callbackCount: 0,
//    reset: function() {
//        this.records = undefined;
//        this.callbackCount = 0;
//    }
//};
//
//observer.callbackfn = function(r) {
//    console.log('Observer 1', r);
//    observer.records = r;
//    observer.callbackCount++;
//};
//
//observer2.callbackfn = function(r){
//    console.log('Observer 2', r);
//}
//
//
//Thingy.observe = function(thingy, callback) {
//    // Object.observe(obj, callback, optAcceptList)
//    Object.observe(thingy, callback, [Thingy.INCREMENT,
//        Thingy.MULTIPLY,
//        Thingy.INCREMENT_AND_MULTIPLY,
//        'update']);
//}
//
//Thingy.unobserve = function(thingy, callback) {
//    Object.unobserve(thingy);
//}
//var thingy = new Thingy(2, 4);
//// 监听thingy
//Object.observe(thingy, observer.callbackfn);
//Thingy.observe(thingy, observer2.callbackfn);
//
//// 调用thingy暴露的方法
//thingy.increment(3);               // { a: 5, b: 7 }
//thingy.b++;                        // { a: 5, b: 8 }
//thingy.multiply(2);                // { a: 10, b: 16 }
//thingy.a++;                        // { a: 11, b: 16 }
//thingy.incrementAndMultiply(2, 2); // { a: 26, b: 36 }










//var model = ['Buy some milk', 'Learn to code', 'Wear some plaid'];
//var count = 0;
//
//Array.observe(model, function(changeRecords) {
//    count++;
//    console.log('Array observe', changeRecords, count);
//});

//model[0] = 'Teach Paul Lewis to code';
//model[1] = 'Channel your inner Paul Irish';








</script>
</body>
</html>